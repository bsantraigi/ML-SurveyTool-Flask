{% extends "layout.html" %}

{% block content %}
	<div class="content-section border p-3">
		<h3>Chat History</h3>
		<!-- chat history: loop through and print utterances from question.context -->
		{% for utterance, speaker in question.context %}
			<div class="row">
				<div class="col-md-6 small">
					<p>
					<strong>{{ speaker }}</strong>: {{ utterance }}
					</p>
				</div>
			</div>
		{% endfor %}

		<!-- response from System 1 and 2 in side-by-side columns -->
		<div class="row">
			<div class="col-md-6 border-right p-3">
				<div class="ml-3">
					<h4>System 1 Response</h3>
					<p class="small"><strong>Agent:</strong> {{ question.response_a }} </p>
				</div>
			</div>
			<div class="col-md-6 p-3">
				<h4>System 2 Response</h3>
				<p class="small"> <strong>Agent:</strong>{{ question.response_b }} </p>
			</div>
		</div>


		<!-- two div columns side by side -->



		<!-- form to submit user's response -->

		<form class="border p-3 m-3" method="POST" action="">
			{{ form.hidden_tag() }}
			<fieldset>
				<div class="row">
					<div class="col-md-6 border-right p-3">
						<h4 class="border-bottom pb-3 mb-3">Answer the questions below</h4>
						<div class="form-group">
							{{ form.q1.label(class="form-control-label small") }}
							{{ form.q1(class="custom-select custom-select-sm") }}
							<small id="help_q1" class="form-text text-muted">
								ðŸ›ˆ {{ form.q1.description }}
							</small>
						</div>
						<div class="form-group">
							{{ form.q2.label(class="form-control-label small") }}
							{{ form.q2(class="custom-select custom-select-sm") }}
							<small id="help_q2" class="form-text text-muted">
								ðŸ›ˆ {{ form.q2.description }}
							</small>
						</div>
						<div class="form-group">
							{{ form.q3.label(class="form-control-label small") }}
							{{ form.q3(class="custom-select custom-select-sm") }}
							<small id="help_q3" class="form-text text-muted">
								ðŸ›ˆ {{ form.q3.description }}
							</small>
						</div>
						<div class="form-group">
							{{ form.q4.label(class="form-control-label small") }}
							{{ form.q4(class="custom-select custom-select-sm") }}
							<small id="help_q4" class="form-text text-muted">
								ðŸ›ˆ {{ form.q4.description }}
							</small>
						</div>
					</div>
					<!-- second column -->
					<div class="col-md-6 p-3">
						<h4 class="border-bottom pb-3 mb-3">Answer the questions below</h4>
						<div class="form-group">
							{{ form.q1.label(class="form-control-label small") }}
							{{ form.q1(class="custom-select custom-select-sm") }}
							<small id="help_q1" class="form-text text-muted">
								ðŸ›ˆ {{ form.q1.description }}
							</small>
						</div>
						<div class="form-group">
							{{ form.q2.label(class="form-control-label small") }}
							{{ form.q2(class="custom-select custom-select-sm") }}
							<small id="help_q2" class="form-text text-muted">
								ðŸ›ˆ {{ form.q2.description }}
							</small>
						</div>
						<div class="form-group">
							{{ form.q3.label(class="form-control-label small") }}
							{{ form.q3(class="custom-select custom-select-sm") }}
							<small id="help_q3" class="form-text text-muted">
								ðŸ›ˆ {{ form.q3.description }}
							</small>
						</div>
						<div class="form-group">
							{{ form.q4.label(class="form-control-label small") }}
							{{ form.q4(class="custom-select custom-select-sm") }}
							<small id="help_q4" class="form-text text-muted">
								ðŸ›ˆ {{ form.q4.description }}
							</small>
						</div>
						<div class="form-group invisible">
							{{ form.hidden_timestamp_start }}
							{{ form.hidden_timestamp_end }}
						</div>
					</div>
				</div>
			</fieldset>
			<div class="form-group">
				{{ form.submit(class="btn btn-outline-info") }}
			</div>
		</form>
	</div>
{% endblock content %}

<script>
	// get the current time and store it in the hidden_time_start field
	// when the page loads
	window.onload = function() {
		var time_start = new Date().getTime();
		document.getElementById("hidden_time_start").value = time_start;
	};

	// get the current time and store it in the hidden_time_end field
	// when the form is submitted
	function submitForm() {
		var time_end = new Date().getTime();
		document.getElementById("hidden_time_end").value = time_end;
	}

	// add the submitForm function to the form's onsubmit event
	document.getElementById("form").onsubmit = submitForm;
</script>

